/* SANCIONES */
INSERT INTO CON_CONSULTA
   (IDINSTITUCION, 
   IDCONSULTA, 
   DESCRIPCION, 
   GENERAL, 
   TIPOCONSULTA, 
   IDMODULO, 
   FECHAMODIFICACION, 
   USUMODIFICACION, 
   BASES, 
   IDTABLA, 
   ESEXPERTA,
   SENTENCIA, 
   OBSERVACIONES, 
   FECHABAJA, 
   IDOBJETIVO, 
   IDCLASE, 
   IDCLASECOMUNICACION)
   VALUES
   (2000, 
    (SELECT MAX(IDCONSULTA) + 1
		FROM CON_CONSULTA CONS
	   WHERE CONS.IDINSTITUCION = 2000
	   AND CONS.IDCONSULTA < 630000),
	'MIGRACION SANCIONES: SANCIONES',
   1,
   'C',
   3,
   TO_DATE(SYSDATE,'DD/MM/YY'),
   1,
   NULL,
   NULL,
   1,
   to_clob('<SELECT> SELECT NVL( CEN_PERSONA.NOMBRE,'' '') || '' '' || NVL( CEN_PERSONA.APELLIDOS1,'' '') || '' '' || NVL( CEN_PERSONA.APELLIDOS2,'''') AS NOMBRE_LETRADO,
				CEN_TIPOSANCION.DESCRIPCION AS TIPOSANCION, 
				CEN_INSTITUCION.ABREVIATURA AS INSTITUCION_SANCIONADOR, 
				CEN_SANCION.REFCGAE,  
				CEN_SANCION.REFCOLEGIO,  				
				CEN_SANCION.CHKFIRMEZA, 
				TO_CHAR(CEN_SANCION.FECHAINICIO,''dd/mm/yyyy'') AS FECHAINICIO, 
				TO_CHAR(CEN_SANCION.FECHAFIN,''dd/mm/yyyy'') AS FECHAFIN, 
				TO_CHAR(CEN_SANCION.FECHAFIRMEZA,''dd/mm/yyyy'') AS FECHAFIRMEZA, 
				TO_CHAR(CEN_SANCION.FECHAACUERDO,''dd/mm/yyyy'') AS FECHAACUERDO, 
				CEN_SANCION.CHKREHABILITADO, 
				TO_CHAR(CEN_SANCION.FECHAREHABILITADO,''dd/mm/yyyy'') AS FECHAREHABILITADO, 
				TO_CHAR(CEN_SANCION.FECHAARCHIVADA,''dd/mm/yyyy'') AS FECHAARCHIVADA, 
				CEN_SANCION.CHKARCHIVADA, 
				CEN_SANCION.TEXTO, 
				CEN_SANCION.OBSERVACIONES </SELECT>
			<FROM>
			FROM  
				CEN_SANCION,  CEN_PERSONA, 	CEN_TIPOSANCION, CEN_INSTITUCION
			</FROM>
			<WHERE>
			WHERE  CEN_SANCION.IDINSTITUCIONSANCION = CEN_INSTITUCION.IDINSTITUCION						 										
				AND  CEN_SANCION.IDPERSONA = CEN_PERSONA.IDPERSONA 
				AND  CEN_SANCION.IDTIPOSANCION = CEN_TIPOSANCION.IDTIPOSANCION			
	            AND  CEN_SANCION.IDINSTITUCION = %%IDINSTITUCION%%			 										
	            AND  CEN_SANCION.IDPERSONA = %%IDPERSONA%%						 										
	            AND  CEN_SANCION.IDSANCION = %%IDSANCION%%
			</WHERE>'),
   NULL,
   NULL,
   4,
   NULL,
   2
   );  


/* ORDEN MANDATOS */
INSERT INTO CON_CONSULTA
   (IDINSTITUCION, 
   IDCONSULTA, 
   DESCRIPCION, 
   GENERAL, 
   TIPOCONSULTA, 
   IDMODULO, 
   FECHAMODIFICACION, 
   USUMODIFICACION, 
   BASES, 
   IDTABLA, 
   ESEXPERTA,
   SENTENCIA, 
   OBSERVACIONES, 
   FECHABAJA, 
   IDOBJETIVO, 
   IDCLASE, 
   IDCLASECOMUNICACION)
   VALUES
   (2000, 
    (SELECT MAX(IDCONSULTA) + 1
		FROM CON_CONSULTA CONS
	   WHERE CONS.IDINSTITUCION = 2000
	   AND CONS.IDCONSULTA < 630000),
	'MIGRACION ORDEN MANDATOS: ORDEN MANDATOS',
   1,
   'C',
   3,
   TO_DATE(SYSDATE,'DD/MM/YY'),
   1,
   NULL,
   NULL,
   1,
   to_clob('<SELECT>
			SELECT MANDATOS.IDINSTITUCION, MANDATOS.IDPERSONA, MANDATOS.IDCUENTA, MANDATOS.IDMANDATO, MANDATOS.TIPOMANDATO, MANDATOS.REFMANDATOSEPA, MANDATOS.TIPOPAGO, MANDATOS.ESQUEMA, MANDATOS.AUTORIZACIONB2B, MANDATOS.ACREEDOR_TIPOID, MANDATOS.ACREEDOR_ID, MANDATOS.ACREEDOR_NOMBRE, MANDATOS.ACREEDOR_DOMICILIO, MANDATOS.ACREEDOR_CODIGOPOSTAL, MANDATOS.ACREEDOR_IDPAIS, MANDATOS.ACREEDOR_PAIS, MANDATOS.ACREEDOR_IDPROVINCIA, MANDATOS.ACREEDOR_PROVINCIA, MANDATOS.ACREEDOR_IDPOBLACION, MANDATOS.ACREEDOR_POBLACION, MANDATOS.DEUDOR_TIPOID, MANDATOS.DEUDOR_ID, 
			CUENTAS.FECHABAJA, CUENTAS.TITULAR AS DEUDOR_NOMBRE, MANDATOS.DEUDOR_DOMICILIO, MANDATOS.DEUDOR_CODIGOPOSTAL, MANDATOS.DEUDOR_IDPAIS, MANDATOS.DEUDOR_PAIS, MANDATOS.DEUDOR_IDPROVINCIA, MANDATOS.DEUDOR_PROVINCIA, MANDATOS.DEUDOR_IDPOBLACION, MANDATOS.DEUDOR_POBLACION, F_SIGA_GETNCOL_NCOM(MANDATOS.IDINSTITUCION, MANDATOS.IDPERSONA) AS DEUDOR_NCOLEGIADO, 
			TO_CHAR(MANDATOS.FIRMA_FECHA, ''DD/MM/YYYY'') AS FIRMA_FECHA, MANDATOS.FIRMA_LUGAR, MANDATOS.IDFICHEROFIRMA, TO_CHAR(MANDATOS.FECHAUSO, ''DD/MM/YYYY'') AS FECHAUSO, CUENTAS.IBAN AS IBAN, BANCOS.BIC AS BIC, BANCOS.NOMBRE AS BANCO, TO_CHAR(MANDATOS.FECHACREACION, ''DD/MM/YYYY'') AS FECHACREACION, MANDATOS.USUCREACION, TO_CHAR(MANDATOS.FECHAMODIFICACION, ''DD/MM/YYYY'') AS FECHAMODIFICACION, MANDATOS.USUMODIFICACION
			</SELECT>
			<FROM>
			FROM CEN_MANDATOS_CUENTASBANCARIAS MANDATOS, CEN_CUENTASBANCARIAS CUENTAS, CEN_BANCOS BANCOS 
			</FROM>
			<WHERE>
			WHERE CUENTAS.IDINSTITUCION = MANDATOS.IDINSTITUCION AND CUENTAS.IDPERSONA = MANDATOS.IDPERSONA 
			AND CUENTAS.IDCUENTA = MANDATOS.IDCUENTA AND BANCOS.CODIGO = CUENTAS.CBO_CODIGO
			AND MANDATOS.IDINSTITUCION = %%IDINSTITUCION%% AND MANDATOS.IDPERSONA = %%IDPERSONA%% AND MANDATOS.IDCUENTA = %%IDCUENTA%%
			</WHERE>'),
   NULL,
   NULL,
   4,
   NULL,
   3
   );   

/* ANEXOS MANDATOS */
INSERT INTO CON_CONSULTA
   (IDINSTITUCION, 
   IDCONSULTA, 
   DESCRIPCION, 
   GENERAL, 
   TIPOCONSULTA, 
   IDMODULO, 
   FECHAMODIFICACION, 
   USUMODIFICACION, 
   BASES, 
   IDTABLA, 
   ESEXPERTA,
   SENTENCIA, 
   OBSERVACIONES, 
   FECHABAJA, 
   IDOBJETIVO, 
   IDCLASE, 
   IDCLASECOMUNICACION)
   VALUES
   (2000, 
    (SELECT MAX(IDCONSULTA) + 1
		FROM CON_CONSULTA CONS
	   WHERE CONS.IDINSTITUCION = 2000
	   AND CONS.IDCONSULTA < 630000),
	'MIGRACION ANEXOS MANDATOS: ANEXOS MANDATOS',
   1,
   'C',
   3,
   TO_DATE(SYSDATE,'DD/MM/YY'),
   1,
   NULL,
   NULL,
   1,
   to_clob('<SELECT>
			SELECT MANDATOS.IDINSTITUCION AS IDINSTITUCION, MANDATOS.IDPERSONA AS IDPERSONA, MANDATOS.IDCUENTA AS IDCUENTA, MANDATOS.IDMANDATO AS IDMANDATO, NULL AS IDANEXO, NULL AS ORIGEN, NULL AS DESCRIPCION, TO_CHAR(MANDATOS.FIRMA_FECHA, ''DD/MM/YYYY'') AS FIRMA_FECHA, MANDATOS.FIRMA_LUGAR AS FIRMA_LUGAR, MANDATOS.IDFICHEROFIRMA AS IDFICHEROFIRMA, TO_CHAR(MANDATOS.FECHACREACION, ''DD/MM/YYYY'') AS FECHACREACION, MANDATOS.USUCREACION AS USUCREACION, TO_CHAR(MANDATOS.FECHAMODIFICACION, ''DD/MM/YYYY'') AS FECHAMODIFICACION, MANDATOS.USUMODIFICACION AS USUMODIFICACION, MANDATOS.FECHACREACION AS FECHAORDEN, MANDATOS.FECHAUSO, NULL AS ESAUTOMATICO
			</SELECT>
			<FROM>
			FROM CEN_MANDATOS_CUENTASBANCARIAS MANDATOS
			</FROM>
			<WHERE>
			WHERE MANDATOS.IDINSTITUCION = %%IDINSTITUCION%%
			AND MANDATOS.IDPERSONA = %%IDPERSONA%%
			AND MANDATOS.IDCUENTA = %%IDCUENTA%%
			AND MANDATOS.IDMANDATO = %%IDMANDATO%%
			</WHERE>
			UNION ALL 
			<SELECT>
			SELECT ANEXOS.IDINSTITUCION, ANEXOS.IDPERSONA, ANEXOS.IDCUENTA, ANEXOS.IDMANDATO, ANEXOS.IDANEXO, ANEXOS.ORIGEN, ANEXOS.DESCRIPCION, TO_CHAR(ANEXOS.FIRMA_FECHA, ''DD/MM/YYYY'') AS FIRMA_FECHA, ANEXOS.FIRMA_LUGAR, ANEXOS.IDFICHEROFIRMA, TO_CHAR(ANEXOS.FECHACREACION, ''DD/MM/YYYY'') AS FECHACREACION, ANEXOS.USUCREACION, TO_CHAR(ANEXOS.FECHAMODIFICACION, ''DD/MM/YYYY'') AS FECHAMODIFICACION, ANEXOS.USUMODIFICACION, ANEXOS.FECHACREACION AS FECHAORDEN, NULL AS FECHAUSO, ANEXOS.ESAUTOMATICO
			</SELECT>
			<FROM>
			FROM CEN_ANEXOS_CUENTASBANCARIAS ANEXOS
			</FROM>
			<WHERE>
			WHERE ANEXOS.IDINSTITUCION = %%IDINSTITUCION%%
			AND ANEXOS.IDPERSONA = %%IDPERSONA%%
			AND ANEXOS.IDCUENTA = %%IDCUENTA%%
			AND ANEXOS.IDMANDATO = %%IDMANDATO%%
			</WHERE>
			<ORDERBY>
			ORDER BY FECHAORDEN ASC
			</ORDERBY>'),
   NULL,
   NULL,
   4,
   NULL,
   4
   ); 
   
   
   /* QUERY DESTINATARIOS */
								  
INSERT INTO CON_CONSULTA
   (IDINSTITUCION, 
   IDCONSULTA, 
   DESCRIPCION, 
   GENERAL, 
   TIPOCONSULTA, 
   IDMODULO, 
   FECHAMODIFICACION, 
   USUMODIFICACION, 
   BASES, 
   IDTABLA, 
   ESEXPERTA,
   SENTENCIA, 
   OBSERVACIONES, 
   FECHABAJA, 
   IDOBJETIVO, 
   IDCLASE, 
   IDCLASECOMUNICACION)
   VALUES
   (2000, 
   (SELECT MAX(IDCONSULTA) + 1
		FROM CON_CONSULTA CONS
	   WHERE CONS.IDINSTITUCION = 2000
	   AND CONS.IDCONSULTA < 630000),
   'MIGRACION SANCIONES: CONSULTA DESTINATARIOS',
   1,
   'I',
   3,
   TO_DATE(SYSDATE,'DD/MM/YY'),
   1,
   NULL,
   NULL,
   1,  
	   to_clob('<SELECT>Select Per.Nombre As \"nombre\",
	       Trim(Per.Apellidos1 || '' '' || Per.Apellidos2) As \"apellidos\",
	       Col.Ncolegiado As \"numcol\",
		   Col.Idpersona As "IDPERSONA",
	       --ini obligatorio por ser consulta destinatarios
	       Cen_Direcciones.Domicilio As \"DOMICILIO\",
	       Cen_Direcciones.Codigopostal As \"CODIGOPOSTAL\",
	       Cen_Direcciones.Idpoblacion As \"IDPOBLACION\",
	       Cen_Direcciones.Idprovincia As \"IDPROVINCIA\",
	       Cen_Direcciones.Idpais As \"IDPAIS\",
	       Cen_Direcciones.Correoelectronico As \"CORREOELECTRONICO\",
	       Cen_Direcciones.Movil As \"MOVIL\",
	       Cen_Direcciones.Fax1 As \"FAX1\",
	       Cen_Direcciones.Fax2 As \"FAX2\"
	</SELECT><FROM> From Cen_Persona Per, Cen_Colegiado Col, Cen_Direcciones, Cen_Direccion_Tipodireccion Tip, CEN_SANCION SANCION  </FROM>
	<WHERE> Where Per.Idpersona = Col.Idpersona
	   And Col.Idpersona = Cen_Direcciones.Idpersona
	   And Col.Idinstitucion = Cen_Direcciones.Idinstitucion
	   And Cen_Direcciones.Idinstitucion = Tip.Idinstitucion
	   And Cen_Direcciones.Idpersona = Tip.Idpersona
	   And Cen_Direcciones.Iddireccion = Tip.Iddireccion
	   And Cen_Direcciones.Fechabaja Is Null
	   And Tip.Idtipodireccion = 3
	   And Col.Idinstitucion =  %%IDINSTITUCION%%
	   And Col.Idpersona = %%IDPERSONA%%,
	   And SANCION.IDPERSONA = Col.Idpersona	
   	   And SANCION.IDSANCION = %%IDSANCION%%
	   And SANCION.IDINSTITUCION = Col.Idinstitucion
	</WHERE>'),
   NULL,
   NULL,
   1,
   NULL,
   2 
   );
   
   
   INSERT INTO CON_CONSULTA
   (IDINSTITUCION, 
   IDCONSULTA, 
   DESCRIPCION, 
   GENERAL, 
   TIPOCONSULTA, 
   IDMODULO, 
   FECHAMODIFICACION, 
   USUMODIFICACION, 
   BASES, 
   IDTABLA, 
   ESEXPERTA,
   SENTENCIA, 
   OBSERVACIONES, 
   FECHABAJA, 
   IDOBJETIVO, 
   IDCLASE, 
   IDCLASECOMUNICACION)
   VALUES
   (2000, 
   (SELECT MAX(IDCONSULTA) + 1
		FROM CON_CONSULTA CONS
	   WHERE CONS.IDINSTITUCION = 2000
	   AND CONS.IDCONSULTA < 630000),
   'MIGRACION ORDEN MANDATOS: CONSULTA DESTINATARIOS',
   1,
   'I',
   3,
   TO_DATE(SYSDATE,'DD/MM/YY'),
   1,
   NULL,
   NULL,
   1,  
	   to_clob('<SELECT>Select Per.Nombre As \"nombre\",
	       Trim(Per.Apellidos1 || '' '' || Per.Apellidos2) As \"apellidos\",
	       Col.Ncolegiado As \"numcol\",
		   Col.Idpersona As "IDPERSONA",
	       --ini obligatorio por ser consulta destinatarios
	       Cen_Direcciones.Domicilio As \"DOMICILIO\",
	       Cen_Direcciones.Codigopostal As \"CODIGOPOSTAL\",
	       Cen_Direcciones.Idpoblacion As \"IDPOBLACION\",
	       Cen_Direcciones.Idprovincia As \"IDPROVINCIA\",
	       Cen_Direcciones.Idpais As \"IDPAIS\",
	       Cen_Direcciones.Correoelectronico As \"CORREOELECTRONICO\",
	       Cen_Direcciones.Movil As \"MOVIL\",
	       Cen_Direcciones.Fax1 As \"FAX1\",
	       Cen_Direcciones.Fax2 As \"FAX2\"
	</SELECT><FROM> From Cen_Persona Per, Cen_Colegiado Col, Cen_Direcciones, Cen_Direccion_Tipodireccion Tip, CEN_MANDATOS_CUENTASBANCARIAS MANDATOS </FROM>
	<WHERE> Where Per.Idpersona = Col.Idpersona
	   And Col.Idpersona = Cen_Direcciones.Idpersona
	   And Col.Idinstitucion = Cen_Direcciones.Idinstitucion
	   And Cen_Direcciones.Idinstitucion = Tip.Idinstitucion
	   And Cen_Direcciones.Idpersona = Tip.Idpersona
	   And Cen_Direcciones.Iddireccion = Tip.Iddireccion
	   And Cen_Direcciones.Fechabaja Is Null
	   And Tip.Idtipodireccion = 3
	   And Col.Idinstitucion =  %%IDINSTITUCION%%
	   And Col.Idpersona = %%IDPERSONA%%,
	   And MANDATOS.IDINSTITUCION = Col.Idinstitucion AND MANDATOS.IDPERSONA = Col.Idpersona AND MANDATOS.IDCUENTA = %%IDCUENTA%%
	</WHERE>'),
   NULL,
   NULL,
   1,
   NULL,
   3 
   );
   
   INSERT INTO CON_CONSULTA
   (IDINSTITUCION, 
   IDCONSULTA, 
   DESCRIPCION, 
   GENERAL, 
   TIPOCONSULTA, 
   IDMODULO, 
   FECHAMODIFICACION, 
   USUMODIFICACION, 
   BASES, 
   IDTABLA, 
   ESEXPERTA,
   SENTENCIA, 
   OBSERVACIONES, 
   FECHABAJA, 
   IDOBJETIVO, 
   IDCLASE, 
   IDCLASECOMUNICACION)
   VALUES
   (2000, 
   (SELECT MAX(IDCONSULTA) + 1
		FROM CON_CONSULTA CONS
	   WHERE CONS.IDINSTITUCION = 2000
	   AND CONS.IDCONSULTA < 630000),
   'MIGRACION ANEXOS MANDATOS: CONSULTA DESTINATARIOS',
   1,
   'I',
   3,
   TO_DATE(SYSDATE,'DD/MM/YY'),
   1,
   NULL,
   NULL,
   1,  
	   to_clob('<SELECT>Select Per.Nombre As \"nombre\",
	       Trim(Per.Apellidos1 || '' '' || Per.Apellidos2) As \"apellidos\",
	       Col.Ncolegiado As \"numcol\",
		   Col.Idpersona As "IDPERSONA",
	       --ini obligatorio por ser consulta destinatarios
	       Cen_Direcciones.Domicilio As \"DOMICILIO\",
	       Cen_Direcciones.Codigopostal As \"CODIGOPOSTAL\",
	       Cen_Direcciones.Idpoblacion As \"IDPOBLACION\",
	       Cen_Direcciones.Idprovincia As \"IDPROVINCIA\",
	       Cen_Direcciones.Idpais As \"IDPAIS\",
	       Cen_Direcciones.Correoelectronico As \"CORREOELECTRONICO\",
	       Cen_Direcciones.Movil As \"MOVIL\",
	       Cen_Direcciones.Fax1 As \"FAX1\",
	       Cen_Direcciones.Fax2 As \"FAX2\"
	</SELECT><FROM> From Cen_Persona Per, Cen_Colegiado Col, Cen_Direcciones, Cen_Direccion_Tipodireccion Tip, CEN_ANEXOS_CUENTASBANCARIAS ANEXOS</FROM>
	<WHERE> Where Per.Idpersona = Col.Idpersona
	   And Col.Idpersona = Cen_Direcciones.Idpersona
	   And Col.Idinstitucion = Cen_Direcciones.Idinstitucion
	   And Cen_Direcciones.Idinstitucion = Tip.Idinstitucion
	   And Cen_Direcciones.Idpersona = Tip.Idpersona
	   And Cen_Direcciones.Iddireccion = Tip.Iddireccion
	   And Cen_Direcciones.Fechabaja Is Null
	   And Tip.Idtipodireccion = 3
	   And Col.Idinstitucion =  %%IDINSTITUCION%%
	   And Col.Idpersona = %%IDPERSONA%%,
	   And ANEXOS.IDINSTITUCION = Col.Idinstitucion AND ANEXOS.IDPERSONA = Col.Idpersona AND ANEXOS.IDCUENTA = %%IDCUENTA%% AND ANEXOS.IDMANDATO = %%IDMANDATO%%
	</WHERE>'),
   NULL,
   NULL,
   1,
   NULL,
   4
   );
   
   COMMIT;
   